#!/usr/bin/env zsh

# --------------------------------------------------------------------------
#   ZSH → bin → 4C
# --------------------------------------------------------------------------
source $HOME/.env
source $DOTFILES_PATH_ZSH/log

# Set variables
SINGLE_SHOT="false"

# Intro
log_intro "4C"

# Check for mounted drive
if ! [[ -d "$VOL_THIN_4C" && -r "$VOL_THIN_4C" && -x "$VOL_THIN_4C" ]]; then
    log_error_exit "Volume not mounted, dummy."
fi

# Check arguments
while getopts "s" flag; do
    case ${flag} in
    s) SINGLE_SHOT="true"
    ;;
    esac
done

# Main
cd $VOL_THIN_4C
if [[ $SINGLE_SHOT == 'true' ]]; then
    log_step "Pulling thread $1"
    4chan --threads --single-shot "$1"
else
    log_step "Watching thread $1" 
    4chan --threads "$1"
fi
